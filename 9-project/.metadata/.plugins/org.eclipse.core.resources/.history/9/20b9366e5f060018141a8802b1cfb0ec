package com.kaishengit.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

import org.apache.commons.dbutils.BasicRowProcessor;
import org.apache.commons.dbutils.GenerousBeanProcessor;
import org.apache.commons.dbutils.ResultSetHandler;
import org.apache.commons.dbutils.handlers.BeanListHandler;
import org.apache.commons.dbutils.handlers.ScalarHandler;

import com.kaishengit.entity.SaleChance;
import com.kaishengit.util.DbHelp;

public class SaleDao {

	public int save(SaleChance saleChance) {
		String sql = "insert into sale_chance (name, cust_id, worth,process,content,last_time,account_id) values (?,?,?,?,?,?,?)";;
		return DbHelp.executeInsert(sql, saleChance.getName(), saleChance.getCustId(),saleChance.getWorth(),saleChance.getProcess(),saleChance.getContent(),saleChance.getLastTime(),saleChance.getAccountId());
	}

	public int countByAccountId(int accountId) {
		String sql = "select count(*) from sale_chance where account_id = ?";
		return DbHelp.query(sql, new ScalarHandler<Long>(), accountId).intValue();
	}

	public List<SaleChance> findListByAccountIdAndPage(int accountId, int start, int pageSize) {
		String sql = "select * from sale_chance sc inner JOIN t_customer c ON sc.cust_id = c.id where sc.account_id = ? limit ?,?";
//		return DbHelp.query(sql, new BeanListHandler<>(SaleChance.class, new BasicRowProcessor(new GenerousBeanProcessor())), accountId, start, pageSize);
		return DbHelp.query(sql, new ResultSetHandler<List<SaleChance>>() {

			@Override
			public List<SaleChance> handle(ResultSet rs) throws SQLException {
				while(rs.next()) {
					
					
					
					
				}
				return null;
			}
		}, accountId, start, pageSize);
	}	

}
